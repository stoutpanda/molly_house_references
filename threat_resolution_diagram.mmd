flowchart TD
    ThreatAppears["Threat Appears"]
    
    ThreatAppears --> Context{{"Context of Appearance?"}}
    
    Context -->|Festivity| InWinningSet{{"Scored in Winning Set?"}}
    Context -->|Market Discard| ExposeInfamous["GOSSIP<br/>EXPOSE MOST<br/>INFAMOUS"]
    Context -->|End of Turn| RevealedInformer{{"Player is<br/>Revealed Informer?"}}
    Context -->|End of Week| ExposeAllPlayers["GOSSIP<br/>EXPOSE PLAYERS"]
    
    InWinningSet -->|Yes| SafeFoiled["SAFE - Foiled"]
    InWinningSet -->|No| PlayedByCommunity{{"Played by Community?"}}
    
    RevealedInformer -->|Yes| SafeNoExposure["SAFE - No Exposure"]
    RevealedInformer -->|No| GossipNoExposure["GOSSIP - No Exposure"]
    
    PlayedByCommunity -->|Yes| ExposeAll["GOSSIP<br/>EXPOSE ALL<br/>PLAYERS"]
    PlayedByCommunity -->|No| ExposePlayer["GOSSIP<br/>EXPOSE PLAYER"]
    
    SafeFoiled --> PrideRule["Pride Rule:<br/>May take cubes"]
    
    %% Styling
    classDef threat fill:#d73027,stroke:#333,stroke-width:2px,color:#fff
    classDef decision fill:#fdae61,stroke:#333,stroke-width:2px
    classDef safe fill:#1a9850,stroke:#333,stroke-width:2px,color:#fff
    classDef gossip fill:#fd8d3c,stroke:#333,stroke-width:2px
    classDef pride fill:#4daf4a,stroke:#333,stroke-width:2px
    
    class ThreatAppears threat
    class Context,InWinningSet,PlayedByCommunity,RevealedInformer decision
    class SafeFoiled,SafeNoExposure safe
    class ExposeInfamous,ExposeAllPlayers,GossipNoExposure,ExposeAll,ExposePlayer gossip
    class PrideRule pride
